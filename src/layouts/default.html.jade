mixin menu(menuItems, maxLevel)
    - maxLevel = maxLevel || 100
    ul.nav
        each item in menuItems
            li(class=[item.state == 'current' ? 'current' : null, item.children ? 'hasChildren' : null])
                div
                    a(href=item.url)= item.title
                unless maxLevel == 1
                    if item.children && item.state != false
                        +menu(item.children, maxLevel--)

- menu = generateMenu(document.url, 'pages')
- secondMenu = []
each item in menu
    if item.children && item.state != false
        - secondMenu = item.children

html
  head
    meta(charset="utf-8")
    title= getPreparedTitle()
    != getBlock('meta').toHTML()
    != getBlock('styles').add(['/styles/style.css']).toHTML()
  body
    aside
        header Pechtold
          div Gesellschaft von Architekten mbH
        nav
            +menu(menu, 1)
        footer
          != partial('address')

    if secondMenu.length
      nav.second
        +menu(secondMenu)

    article
      !=content
      each file in getDocument().getAssociatedFiles().toJSON()
        h3= file.title || file.name
        p
          img(src=file.url)

  != getBlock('scripts').toHTML()